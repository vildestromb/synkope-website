<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Service Content Loading</title>
    <meta name="description" content="Test page for service content loading functionality">
    <meta name="use-content-loader" content="true" />
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }

        .test-controls {
            background: #f5f5f5;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .service-hero {
            background: #1d5f81;
            color: white;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .service-hero h1 {
            margin: 0;
            font-size: 2.5rem;
        }

        .service-content {
            background: white;
        }

        .service-section {
            background: #fafafa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .service-list {
            margin: 15px 0;
            padding-left: 20px;
        }

        .service-list li {
            margin: 8px 0;
        }

        .status {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .error {
            background: #fef3e8;
            color: #b8441f;
        }

        .success {
            background: #e8f5e8;
            color: #1d5f81;
        }

        button {
            background: #eb8822;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
        }

        button:hover {
            background: #1d5f81;
        }

        .footer-section {
            background: #f0f0f0;
            padding: 20px;
            margin-top: 40px;
            border-radius: 5px;
        }

        .footer-bottom {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }

        pre {
            background: #f8f8f8;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Service Content Loader Test</h1>

    <div class="test-controls">
        <h3>Test Controls</h3>
        <p>This page simulates a service page to test content loading functionality.</p>
        <p><strong>Current URL:</strong> <span id="current-url"></span></p>
        <p><strong>Detected Service:</strong> <span id="detected-service">Unknown</span></p>

        <h4>Simulate Different Services:</h4>
        <button onclick="simulateService('ikt-infrastruktur')">IKT-infrastruktur</button>
        <button onclick="simulateService('prosjektstyring')">Prosjektstyring</button>
        <button onclick="simulateService('informasjonssikkerhet')">Informasjonssikkerhet</button>
        <button onclick="simulateService('emc')">EMC</button>

        <div id="status" class="status">Ready to test...</div>
    </div>

    <!-- Service Hero Section -->
    <section class="service-hero">
        <div class="container">
            <div class="service-hero-content">
                <h1>Loading Service Title...</h1>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="service-content">
        <div class="container">
            <div class="service-content">
                <div class="service-main">
                    <div class="service-section">
                        <p>Content will be loaded here from JSON...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer Section for Testing -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Kontakt</h4>
                    <p>Company Name</p>
                    <p>Address</p>
                    <p>Postal Code</p>
                    <p>Org Number</p>
                    <p><a href="mailto:test@example.com">Email</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Test</p>
            </div>
        </div>
    </footer>

    <!-- Debug Information -->
    <div class="test-controls">
        <h3>Debug Information</h3>
        <div id="debug-info">
            <p>Content loader will populate this section...</p>
        </div>

        <h4>Loaded Content Preview:</h4>
        <pre id="content-preview">No content loaded yet</pre>
    </div>

    <script>
        // Update current URL display
        document.getElementById('current-url').textContent = window.location.href;

        // Function to simulate different services by changing the URL
        function simulateService(serviceName) {
            const newUrl = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, `/${serviceName}.html`);

            // Update URL without reloading
            history.replaceState(null, null, newUrl);
            document.getElementById('current-url').textContent = newUrl;

            // Reinitialize content loader
            if (window.serviceContentLoader) {
                window.serviceContentLoader.serviceName = window.serviceContentLoader.detectServiceName();
                document.getElementById('detected-service').textContent = window.serviceContentLoader.serviceName || 'Unknown';

                // Update status
                const status = document.getElementById('status');
                status.textContent = `Simulating ${serviceName}...`;
                status.className = 'status';

                // Reload content
                window.serviceContentLoader.init().then(() => {
                    status.textContent = `Successfully loaded content for ${serviceName}`;
                    status.className = 'status success';

                    // Update debug info
                    updateDebugInfo();
                }).catch((error) => {
                    status.textContent = `Error loading ${serviceName}: ${error.message}`;
                    status.className = 'status error';
                });
            }
        }

        function updateDebugInfo() {
            const debugInfo = document.getElementById('debug-info');
            const contentPreview = document.getElementById('content-preview');

            if (window.serviceContentLoader && window.serviceContentLoader.content) {
                const serviceData = window.serviceContentLoader.content.service_pages[window.serviceContentLoader.serviceName];

                debugInfo.innerHTML = `
                    <p><strong>Service Name:</strong> ${window.serviceContentLoader.serviceName}</p>
                    <p><strong>Language:</strong> ${window.serviceContentLoader.language}</p>
                    <p><strong>Content Loaded:</strong> ${serviceData ? 'Yes' : 'No'}</p>
                    <p><strong>Title:</strong> ${serviceData?.title || 'N/A'}</p>
                `;

                contentPreview.textContent = JSON.stringify(serviceData, null, 2);
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            // Wait a bit for the service content loader to initialize
            setTimeout(() => {
                if (window.serviceContentLoader) {
                    document.getElementById('detected-service').textContent = window.serviceContentLoader.serviceName || 'Unknown';
                    updateDebugInfo();
                } else {
                    document.getElementById('status').textContent = 'Service content loader not found!';
                    document.getElementById('status').className = 'status error';
                }
            }, 1000);
        });
    </script>

    <!-- Include the service content loader -->
    <script src="js/service-content-loader.js"></script>
</body>
</html>
